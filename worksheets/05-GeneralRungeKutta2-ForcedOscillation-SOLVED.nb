(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14173,        296]
NotebookOptionsPosition[     13278,        271]
NotebookOutlinePosition[     13765,        290]
CellTagsIndexPosition[     13722,        287]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
General Second-Order Runge-Kutta \[LongDash] Forced Oscillation \[LongDash] \
SOLVED\
\>", "Section",
 CellChangeTimes->{{3.944067829868867*^9, 3.944067861861581*^9}, {
  3.944068820428216*^9, 3.944068822060533*^9}, {3.944259504220365*^9, 
  3.944259508854402*^9}, {3.9451065856437073`*^9, 3.945106593079445*^9}, {
  3.946308448646846*^9, 3.946308451385337*^9}, {3.946552457165756*^9, 
  3.9465524707004967`*^9}, {3.9465525521152363`*^9, 3.946552554916573*^9}, {
  3.9465788311752863`*^9, 3.946578833173499*^9}, {3.946870573058391*^9, 
  3.9468705830476847`*^9}, {3.946870640652769*^9, 3.946870640891918*^9}, {
  3.947291676151257*^9, 3.9472917061453037`*^9}, {3.947294845743719*^9, 
  3.947294852851272*^9}, {3.9475513257039967`*^9, 
  3.9475513301295757`*^9}},ExpressionUUID->"08f90a5e-ac65-4417-8844-\
b6de9f5e59a2"],

Cell[CellGroupData[{

Cell["Analyzed in class, February 7, 2025", "Subtitle",
 CellChangeTimes->{{3.944069658419606*^9, 3.944069670238837*^9}, {
   3.944259441457538*^9, 3.944259441514864*^9}, {3.945368563122921*^9, 
   3.94536856339248*^9}, {3.94630825627395*^9, 3.946308258224854*^9}, {
   3.946308899126011*^9, 3.9463089397149553`*^9}, 3.946311308159807*^9, 
   3.946311633761958*^9, {3.9464799861433*^9, 3.946479993858527*^9}, {
   3.946552494389028*^9, 3.946552494447125*^9}, {3.946870590010352*^9, 
   3.946870590173767*^9}, {3.947291719345838*^9, 3.94729171966033*^9}, {
   3.947357538497875*^9, 3.947357543750285*^9}, {3.947869690489455*^9, 
   3.9478696946403093`*^9}},
 FontSize->18,ExpressionUUID->"13bc130c-7f5e-44a4-9ed0-26cf2333f1d9"],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["General Second-Order Runge-Kutta", "Subsubsection"],
 " ",
 StyleBox["\[LongDash] ",
  FontSize->18],
 "Implementation"
}], "Subsubsection",
 CellChangeTimes->{{3.944067829868867*^9, 3.944067861861581*^9}, {
   3.944068820428216*^9, 3.944068822060533*^9}, {3.944139625524349*^9, 
   3.94413963984907*^9}, {3.944259530711527*^9, 3.9442595335136843`*^9}, {
   3.946308843711494*^9, 3.946308852743926*^9}, {3.946552584033918*^9, 
   3.94655258499282*^9}, {3.946553085603167*^9, 3.9465530927589693`*^9}, {
   3.946553127697163*^9, 3.946553140310534*^9}, {3.946553227601028*^9, 
   3.946553228435363*^9}, {3.946871710460898*^9, 3.946871721272339*^9}, {
   3.946873011087474*^9, 3.946873020909573*^9}, {3.946873070473049*^9, 
   3.946873074941926*^9}, {3.9469178278273907`*^9, 3.9469178324317427`*^9}, {
   3.946917866410346*^9, 3.946917880596525*^9}, 3.9469181859994*^9, {
   3.946918258581699*^9, 3.9469182592720833`*^9}, {3.947291970174375*^9, 
   3.947291970950597*^9}},ExpressionUUID->"c4537ea2-5b06-4997-b1a3-\
8bc1dd0cd281"],

Cell["\<\
The implementation will be almost the same as in the damped oscillation \
notebook you completed on Friday.

There are two small things that have to be changed. Figure out what they are \
and then if you still have that code handy, you can almost completely re-use \
what you did in that notebook. Or just write it out again. The more times you \
write it out, the better you will remember it.\
\>", "Text",
 CellChangeTimes->{{3.946577216735734*^9, 3.946577255763145*^9}, {
  3.9465776127813263`*^9, 3.946577613302925*^9}, {3.94657764608307*^9, 
  3.946577646531845*^9}, {3.9465777193898087`*^9, 3.946577719683169*^9}, {
  3.946579021994255*^9, 3.9465790221207657`*^9}, {3.946579169780827*^9, 
  3.946579170167757*^9}, {3.9468715080689917`*^9, 3.946871508170663*^9}, {
  3.946871641516255*^9, 3.9468716425058823`*^9}, {3.946918441140991*^9, 
  3.946918462501031*^9}, {3.946920954799529*^9, 3.946920954799608*^9}, {
  3.946920995256361*^9, 3.9469210046043863`*^9}, {3.94692114338374*^9, 
  3.946921146985736*^9}, {3.947293728354549*^9, 3.947293755073989*^9}, {
  3.9472937881898003`*^9, 3.947293816257216*^9}, {3.947357710858076*^9, 
  3.947357774488488*^9}, {3.947358039310894*^9, 3.9473580404317627`*^9}, {
  3.947359636728589*^9, 3.9473596826557627`*^9}, {3.9474428377526703`*^9, 
  3.947442838048912*^9}},ExpressionUUID->"b6bd8aec-6404-45c7-afcb-\
a05810000b0d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"lambda", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "I", " ", "am", " ", "going", " ", "to", " ", "switch", " ", "to", " ", 
    "a", " ", "different", " ", "letter", " ", "for", " ", "what", " ", "we", 
    " ", "have", " ", "been", " ", "calling", " ", "alpha", " ", "and", " ", 
    "you", " ", "should", " ", 
    RowBox[{"too", ".", " ", "We"}], " ", "are", " ", "running", " ", "out", " ",
     "of", " ", "common", " ", "letters", " ", "and", " ", "I", " ", "will", " ",
     "want", " ", "to", " ", "reuse", " ", "alpha", " ", "for", " ", 
    "something", " ", "else", " ", "in", " ", "the", " ", "next", " ", 
    "notebook", " ", "which", " ", "is", " ", "the", " ", "pendulum", " ", 
    RowBox[{"problem", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rungeKutta2", "[", "cc_", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Extract", " ", "time"}], ",", " ", "position", ",", " ", 
     RowBox[{"and", " ", "velocity", " ", "from", " ", "the", " ", "list"}]}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"curTime", "=", 
     RowBox[{"cc", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"curPosition", "=", 
     RowBox[{"cc", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"curVelocity", "=", 
     RowBox[{"cc", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Compute", " ", "tStar"}], ",", " ", "xStar", ",", " ", 
      "vStar"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"tStar", "=", 
     RowBox[{"curTime", " ", "+", " ", 
      RowBox[{"lambda", " ", "deltaT"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"xStar", "=", 
     RowBox[{"curPosition", "+", 
      RowBox[{"curVelocity", " ", "lambda", " ", "deltaT"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"vStar", "=", 
     RowBox[{"curVelocity", "+", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"curTime", ",", "curPosition", ",", "curVelocity"}], "]"}], 
       "lambda", " ", "deltaT"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Implement", " ", "General", " ", "Second"}], "-", 
      RowBox[{"Order", " ", "Runge"}], "-", "Kutta"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"newTime", "=", 
     RowBox[{"curTime", "+", "deltaT"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"newVelocity", "=", 
     RowBox[{"curVelocity", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox["1", 
             RowBox[{"2", "lambda"}]]}], ")"}], 
          RowBox[{"a", "[", 
           RowBox[{"curTime", ",", "curPosition", ",", "curVelocity"}], 
           "]"}]}], "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"2", "lambda"}]], 
          RowBox[{"a", "[", 
           RowBox[{"tStar", ",", "xStar", ",", "vStar"}], "]"}]}]}], ")"}], 
       "deltaT"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"newPosition", "=", 
     RowBox[{"curPosition", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"curVelocity", "+", "newVelocity"}], ")"}], 
       RowBox[{"deltaT", "/", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "We", " ", "are", " ", "keeping", " ", "track", " ", "of", " ", "the", " ",
       "contribution", " ", "to", " ", "the", " ", "acceleration", " ", "due",
       " ", "to", " ", "the", " ", "external", " ", "force"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     StyleBox[
      RowBox[{
      "newTime", ",", " ", "newPosition", ",", " ", "newVelocity", ",", " ", 
       RowBox[{
        RowBox[{"externalForce", "[", "newTime", "]"}], "/", 
        "springConstant"}]}],
      FontFamily->"Source Code Pro",
      FontWeight->"SemiBold"], 
     StyleBox["}",
      FontFamily->"Source Code Pro",
      FontWeight->"SemiBold"]}]}], "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N", "[", 
   RowBox[{"rungeKutta2", "[", "initialConditions", "]"}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Test", " ", "your", " ", "rungeKutta2", " ", 
    RowBox[{"function", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "output", " ", "just", " ", "below", " ", "should", " ", "be", 
    " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.004", ",", " ", 
       RowBox[{"3.19999", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "7"}]]}], ",", " ", "0.00016", ",", " ", "0.0199999"}], 
      "}"}], "."}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.946554585788775*^9, 3.946554600985629*^9}, {
   3.9465742551984777`*^9, 3.9465744345679827`*^9}, {3.946574467872939*^9, 
   3.946574648077251*^9}, {3.946574785796095*^9, 3.94657478610115*^9}, {
   3.9465749525604067`*^9, 3.946574997114737*^9}, {3.9465752396753397`*^9, 
   3.9465752947604218`*^9}, {3.946575471665202*^9, 3.946575473085905*^9}, {
   3.946575509094503*^9, 3.946575603383017*^9}, {3.946575643659521*^9, 
   3.946575736872139*^9}, {3.946575898897283*^9, 3.946575930369772*^9}, {
   3.946575988483213*^9, 3.946575994062613*^9}, 3.946576482369583*^9, 
   3.9465767357935867`*^9, {3.946577332464587*^9, 3.946577345586329*^9}, {
   3.9468719410196867`*^9, 3.9468720582529173`*^9}, {3.946872089710197*^9, 
   3.946872152804912*^9}, {3.946872209716776*^9, 3.9468722571027327`*^9}, {
   3.946872342354725*^9, 3.9468725645563087`*^9}, {3.946872602195612*^9, 
   3.9468726341898108`*^9}, {3.9468726942536697`*^9, 3.946872701829075*^9}, {
   3.946872746410921*^9, 3.946872824556509*^9}, {3.946905961451304*^9, 
   3.946906043042873*^9}, {3.946906074322236*^9, 3.946906274019094*^9}, {
   3.9469063223257513`*^9, 3.946906349399089*^9}, {3.946906421928132*^9, 
   3.946906553843678*^9}, {3.9469067153710413`*^9, 3.946906735454029*^9}, {
   3.946916423759585*^9, 3.9469164279068604`*^9}, {3.946918601271541*^9, 
   3.94691877812847*^9}, {3.946919367099172*^9, 3.946919382966173*^9}, {
   3.946919425285366*^9, 3.946919470285606*^9}, {3.946919519774931*^9, 
   3.946919524855916*^9}, {3.9469196524959927`*^9, 3.9469196750219603`*^9}, {
   3.946920467727969*^9, 3.946920577237836*^9}, {3.9469206114141006`*^9, 
   3.946920638156053*^9}, {3.9469211129627457`*^9, 3.946921114133129*^9}, {
   3.946921703444685*^9, 3.946921737448655*^9}, {3.94692217267726*^9, 
   3.946922190723619*^9}, {3.9469222493333387`*^9, 3.946922249505706*^9}, {
   3.947291980601458*^9, 3.947292042435215*^9}, {3.94729207561473*^9, 
   3.947292355753295*^9}, {3.9472927713258467`*^9, 3.9472927716720057`*^9}, {
   3.9472934281654253`*^9, 3.9472934284630136`*^9}, {3.947293826982319*^9, 
   3.947293834826887*^9}, {3.9472940636342077`*^9, 3.9472940649211397`*^9}, {
   3.947294474177204*^9, 3.947294512158382*^9}, {3.9472945595746202`*^9, 
   3.9472945617028*^9}, {3.947295461258586*^9, 3.947295480397706*^9}, {
   3.947295784105982*^9, 3.947295785564559*^9}, {3.9473576350276413`*^9, 
   3.947357675078019*^9}, {3.947357804476639*^9, 3.947357824547636*^9}, {
   3.9473579388368187`*^9, 3.9473579456143017`*^9}, {3.9473596071046124`*^9, 
   3.947359615504252*^9}, {3.947442425055962*^9, 3.947442495620247*^9}, {
   3.9474425348941402`*^9, 3.94744254363664*^9}, {3.947442575214226*^9, 
   3.9474426285978603`*^9}, {3.947443048302022*^9, 3.947443052165049*^9}, {
   3.9474430847943172`*^9, 3.947443099266864*^9}, {3.947551000418439*^9, 
   3.947551250554531*^9}, {3.947551422505268*^9, 3.947551432181595*^9}, {
   3.947616775541973*^9, 3.9476168186071577`*^9}, {3.94761808516322*^9, 
   3.947618176517166*^9}, {3.947623394338827*^9, 3.947623403361732*^9}, {
   3.947623441802555*^9, 3.947623458761775*^9}, {3.947691629843411*^9, 
   3.947691723161024*^9}, {3.9476917602558317`*^9, 3.947691858482192*^9}, {
   3.9476919027523603`*^9, 3.947692017220705*^9}, {3.947692118386629*^9, 
   3.94769212745722*^9}, {3.947692508130418*^9, 3.9476926592239723`*^9}, {
   3.947692703447749*^9, 3.947692758512134*^9}, {3.947693788282394*^9, 
   3.9476938104780703`*^9}, {3.947694038135139*^9, 3.947694038595331*^9}, {
   3.947694070821918*^9, 3.947694079740786*^9}, {3.947694117069141*^9, 
   3.94769415504436*^9}, {3.947694197887311*^9, 3.94769419884799*^9}, {
   3.94786897437354*^9, 3.9478690757544403`*^9}, {3.9478691197493057`*^9, 
   3.947869235810699*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"59689b30-df0d-4432-b83e-2e0ccefdd3c5"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1649, 1198},
WindowMargins->{{Automatic, 117}, {Automatic, -720}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
Magnification:>1.25 Inherited,
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"79d99d9c-2760-41a1-b3ad-6f9f4f8469c8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 829, 14, 103, "Section",ExpressionUUID->"08f90a5e-ac65-4417-8844-b6de9f5e59a2"],
Cell[CellGroupData[{
Cell[1412, 38, 726, 10, 69, "Subtitle",ExpressionUUID->"13bc130c-7f5e-44a4-9ed0-26cf2333f1d9"],
Cell[CellGroupData[{
Cell[2163, 52, 1052, 19, 68, "Subsubsection",ExpressionUUID->"c4537ea2-5b06-4997-b1a3-8bc1dd0cd281"],
Cell[3218, 73, 1376, 22, 155, "Text",ExpressionUUID->"b6bd8aec-6404-45c7-afcb-a05810000b0d"],
Cell[4597, 97, 8653, 170, 757, "Input",ExpressionUUID->"59689b30-df0d-4432-b83e-2e0ccefdd3c5"]
}, Open  ]]
}, Open  ]]
}
]
*)

